

\documentclass[twocolumn]{sagej}

\usepackage{graphicx}
      \graphicspath{{./Figures/}}
      \usepackage{amsmath}
	  \usepackage{wrapfig}  %adding these packages so that figures can have text wrapped around them
	  \usepackage[]{epstopdf}
	  \usepackage[]{subfigure}
	  %\usepackage[]{subcaption}
	  %\usepackage[]{caption}
	  %\usepackage[dvipdfm]{graphicx} 
	  %\usepackage{bmpsize}
	  \usepackage{epsfig}
	  \usepackage{booktabs}
	  \usepackage{float}
	  \usepackage{txfonts}
	  \usepackage{comment}
	  \usepackage{adjustbox}
	  %\usepackage{cleveref}
	  \usepackage[hidelinks]{hyperref}
	  \usepackage{nameref}
	  \usepackage{textcomp}
	  \usepackage[T1]{fontenc}
	  \usepackage{tabularx}
	 
%**********************************************************************************************************************************
\begin{comment}	  
	  %to get column spanning figures
	  \usepackage[showframe]{geometry}% http://ctan.org/pkg/geometry
	  \usepackage{lipsum}% http://ctan.org/pkg/lipsum
	  \usepackage{multicol}% http://ctan.org/pkg/multicols
	  \usepackage{graphicx}% http://ctan.org/pkg/graphicx
\end{comment}	  
%**********************************************************************************************************************************

\usepackage{stfloats}				% For placing figure* at the bottom of the page
%\usepackage[caption=false]{subfig}	% Newest subfigure package		


\begin{document}
%
% paper title

\runninghead{Sanford Patterson Popa}

\title{Concurrent SEMG and force myography classification during times of prosthetic socket shift and user fatigue}

\author{Joe Sanford\affilnum{1}, Rita Patterson\affilnum{2} and Dan O. Popa\affilnum{3}}

\affiliation{\affilnum{1}Next Gen Systems Group\\ Dept. of Electrical Engineering, University of Texas-Arlington, Arlington, TX 76019 USA\\
\affilnum{2}Dept. of Family and Osteopathic Manipulative Medicine\\ University of North Texas-Health Science Center, Fort Worth, TX 76107 USA\\
\affilnum{3}Dept. Electrical and Computer Engineering, University of Louisville, Louisville, KY 40292 USA}

\corrauth{Joe Sanford, 7300 Jack Newell Blvd S., Fort Worth, Texas 76118}
\email{sanfordj@uta.edu}

% The paper headers

\begin{abstract}
Surface ElectroMyography (SEMG) has been a long-standing source of signals for control of powered prosthetic devices. By contrast, Force Myography (FMG),  is a more recent alternative to SEMG that has the potential to enhance reliability and avoid operational challenges of SEMG during use. \textbf{Objective:} In this paper we report on experiments  conducted to assess improvements in classification of SEMG signals through  the addition of  collocated  FMG consisting of piezo-resistive  sensors. \textbf{Methods:} Force  sensors detect intrasocket pressure changes upon muscle activation  due to changes in muscle volume during activities of daily living. A heterogeneous sensor configuration  with four SEMG-FMG pairs was investigated as a control input for a powered upper limb prosthetic. Training of two different multilevel neural perceptron networks was employed during classification and trained on data  gathered during experiments simulating socket shift and muscle fatigue. \textbf{Results:} Results indicate that intrasocket  pressure data used in conjunction with surface EMG data can improve classification of human intent and control of a powered prosthetic device compared to traditional, SEMG only systems. \textbf{Significance:} Additional sensors lead to significantly better signal classification during times of user fatigue, poor socket fit, as well as radial and ulnar wrist deviation.  Results from experimentally obtained training data sets are presented.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\keywords{Hand Biomechanics, Human Machine Interface, Physical Human Robot Interaction, Pressure Sensitive Robot Skin, Prosthetic Device}

\maketitle

\section*{Introduction}

Current state-of-art surface myoelectrographic (SEMG) sensors allow amputees to control powered prosthetic or robotic devices.  These sensors determine muscle activation  in a user's residual limb by sensing electrical potential change \cite{Hargrove2007c}.  It has been extensively reported that amputees have regained some lost functionality through the use of  multiple degrees of freedom (DOF) upper-limb prosthetic\cite{Dalley02013}.  After the initial learning curve to use the prosthetic, some users report being able to successfully  operate robotic hands which include  dexterous digits and thumb motion as well as wrist rotation. Although current powered prosthetic devices provide sufficient dexterity to open doors, grasp  glasses  and bottles, and carry grocery  bags\cite{Belter2013}, use of these devices continues  to be limited outside  of the clinical laboratory.  Research is underway to address human-robot  interaction   challenges and improve control of these devices.\par \noindent
Many prosthetic  devices  offer users  control over only a single DOF, thus requiring the user to switch between multiple modes thereby reducing operational   speed  and increasing task completion length. An example of such a task used in clinical settings is to move  a number  of small foam balls between two boxes,  as described  in \cite{Dalley02013}\cite{Dawson2012} or \cite{Mathiowetz1985}.  In this case it was reported that  the time needed  to choose  the desired  action of the powered prosthetic device, and switch between degrees of freedom, comprises a significant  portion of the overall duration of the task \cite{Pilarski2012}.  For a multi-DOF  prosthetic device, it can be a tedious switching burden to control one-DOF-at-a-time. To improve usability, Pilarski, \textit{et, al.}\cite{Pilarski2012} showed that automatic DOF switching could be learned by a control  system using an Actor Critic Model with data collected from a SEMG system.  This method predicts which DOF a user is likely to control next through a reinforcement learning algorithm. Improvements in simulated tasks of daily life were reported, in particular task completion times were reduced by approximately 14\%\cite{Pilarski2012}.  In this study, however, the user was only allowed  to quickly move  between  the relatively gross movements  of the elbow and wrist and was only able to successfully function with two DOFs selected at any given time.  \par \noindent  
Therefore, it is of considerable interest to expand this work to finer and more dexterous movements. However, practical limitations of SEMG sensing technology have often been cited as major challenges for generalizing this approach to SEMG arrays. These limitations include noise and signal degradation over time depending on linear distances along the skin surface above the muscle to be sensed \cite{AsghariOskoei2007b, Hargrove2006b, Young2011}, and differences between limb poses during classification  and training  data sets\cite{Scheme2010a}.  User fatigue and sweat, perspiration within the socket, can also cause a degraded EMG signal.\cite{Ray1983, Abdoli-Eramaki2012, Dimitrova2003}.   A method to compensate for signal losses due to sweat was studied by Tomasini\cite{Tomasini2015}.  In Tomasini's study the EMG sensors used a subject's skin as a common ground. This is still true in modern EMG sensors.  This shared ground was highly variable and caused ground-loops; compensation was found to be possible. \par \noindent 
Signal processing and EMG signal classification for control purposes is still an active research area, including spatial filtering\cite{Hahne2012} and methods of preprocessing data\cite{Hargrove2009}.  Work in the areas of Neural Networks\cite{Chan2000a, Mobasser2005}, Gaussian Mixture Models\cite{Chan2003a, Huang2005}, and other approaches have all produced incremental improvements in signal classification\cite{Derry:2014:EMP:2559636.2559685, Oskoei2006a, Oskoei2008b, Reaz02006}.  \par \noindent 
Relatively few studies have examined the addition of other sensor input modalities to control upper limb prosthetics.   During training, Fougner, \textit{et, al} used accelerometer and an SEMG sensor to help classify grip type\cite{Fougner2011}.  More recent studies interfaced an accelerometer with EMG sensors\cite{Assad2013, Wolf02013}.  Others have proposed force sensors placed in contact the skin used to detect the changes in force and pressure within the socket due to volumetric changes of the forearm.  This technique also known as Force Myography (FMG) \cite{Wininger02008}, Residual Kinetic Imaging (RKI) \cite{Phillips02005}, and Muscle Pressure Mapping (MPM) \cite{Radmand02014} also shows promise in providing an alternate and additional input for signal classification. Craelius, et al referred to this method as Residual Kinetic Imaging (RKI), in 1999 \cite{Craelius01999}, \cite{Curcie02001}, \cite{Phillips02005}.  Separately, Phillips described a device with 32 pressure sensors, allowing lower-arm (transradial) amputees to open and close a simulated prosthetic hand.  Forces measured at the interface of the socket and skin surface of the residual limb were used as control inputs\cite{Phillips02005}.  More recently, Radmand reported making use of a simulated prosthetic socket with 126 pressure sensors to classify eight hand motion classes.  They called the technique ``Muscle Pressure Mapping'' (MPM)\cite{MEC02014}.  \par \noindent
However, few works considered multiple sensor input modalities as control inputs during their experiments.  Fougner, \textit{et, al}'s used accelerometers and EMG signals as mentioned above.  Time-domain features provided grip type information when combined with linear discriminant analysis during arm motions made by the subject; resting in a neutral position, overhead, and outstretched to one side.\cite{Fougner2011}  Thus, prosthetic socket shift, as the subject completed simulated activities of daily life, was taken in to account by the classifier.  Fougner\cite{Fougner02008} has also integrated force sensors in their system as a way to ``address force induced artifacts when predicting grip-pressure'' and has showed promising results.  Similar work was also presented separately by Wininger\cite{Wininger02008}. Previous studies motivating this work collocated SEMG and FMG sensor pair and classification algorithm\cite{SanfordSPIE2015a}. Other work has also shown that it is possible to utilize FMG data in conjunction with grip-selection interfaces as a replacement control input instead of SEMG\cite{SanfordPETRA02015}.  Improvements via the addition of accelerometry data has also been studied. Data from an  accelerometer, used to give arm direction information during static gestures,  was fused with the data from 16 EMG sensors\cite{Assad2013}. In a continuation, in \cite{Wolf02013}, SEMG and accelerometers were used as control input signals for a mobile robot to, ``stop", ``turn", and ``go".  The main focus of the study was not prosthetic control but the authors were able to  map specific arm gestures and move an actuated robotic gripper\cite{Wolf02013}.  Finally, practical discussions and considerations for fusing accelerometer and EMG data were presented by Radmand, et al \cite{Radmand02014}.  This work pointed out the clinically impractical time to train classifiers in a number of possible arm positions and their ``Dynamic training" algorithm was able to reduce training time.\par \noindent
%change the focus of this particular paper
In this paper we report on the use of a \textit{combination} of Surface Electromyography (SEMG) and Force Myography (FMG) sensors along side a neural network classifier to explore classification of data during times of non-ideal prosthetic socket placement due to fatigue, arm position, or socket shift.  Linear offset, as measured across the surface of the skin, has been shown to affect and degrade signal integrity.\cite{Hargrove2006b, AsghariOskoei2007b}. In order to study possible solutions, our previous work\cite{SanfordSPIE2015a} correlated volumetric changes of the carpi flexor and carpi extensor muscles of the subject's forearm, which then induced a detectable pressure as applied to a sensor, to ``ideal'' locations of the SEMG electrodes and ``non-ideal'' locations of the electrodes.  Linear displacement along the surface of the skin from the ``ideal sensor location'' was measured and is included as a means to simulate socket shift during activities of daily living.  This prior work reported on the strong correlation between single pairs of SEMG and pressure sensors \cite{SanfordSPIE2015a}, which suggests that Force Myography is a good complement to SEMG, and may help with correcting its signal degradation over time. This paper details expanded studies and experimentation with four SEMG and four FMG sensors, data fusion utilizing a simplified multilayer perceptron feedforward neural network, a custom socket, and data collocated as a user performs flexion and extension motions of their dominant wrist.  Results show that classification can be improved by at least 3\%, 8\% when classifying radial and ulnar deviation, and upwards of 35\% when a socket is shifted due to normal activities of daily living. \par \noindent
%\end{comment}

\begin{figure}[htbp]
\centering
\subfigure[]{\epsfig{figure=arm_out_no_socket_crop_BW_01.png,width=2.5in}
\label{fig:arm_out_no_socket}}
\subfigure[]{\epsfig{figure=arm_socket_BW_01.png,width=2.5in}
 \label{fig:arm_socket}}
 \caption{a) Subject wearing SEMG and FMG collocated sensors b) Subject wearing simulated prosthetic socket and collocated sensors}

\end{figure}

\section*{Methods}
\label{sec:methods}

Flexion and extension actions were made by a subject and data was recorded via SEMG sensors, FMG sensors, and custom data acquisition hardware.  Placement of the SEMG sensors in ``ideal'' locations on the flexor and extensor muscle bodies was determined by a physical therapist in order to achieve high quality EMG data. The socket and SEMG-FMG sensor pair was then manually moved to ``non-ideal'' locations 1cm and 2cm away from the previously determined ``ideal'' location as measured along the surface of the subject's skin in each of the four cardinal directions.  The flexion and extension movements were then repeated, data was collected, and a signal classification schema built.  Results and discussion of the classification of this data are seen below.  \par \noindent

\subsection*{Experimental Protocol}
\label{sec:protocol}

Experimental data from a single right hand dominant, healthy-limbed twenty-four year old male subject is reported.  The subject was informed of the test procedures, which were approved by the local ethics review committee (UNTHSC IRB  2011-161), and written consent was given by the test subject.  The sensor housing was specifically fabricated for the individual subject using 3D scanning of their forearm and 3D printing.  \par \noindent
A series of four movements and arm configurations were utilized to gather data used during this experiment.  These movements included flexion and extension of the wrist with the sensors in both ``ideal'' and ``non-ideal'' locations relative to the muscle bodies, as the subject's arm was held in different arm positions found during activities of daily living, and while the subject's arm was fatigued.  Radial and ulnar deviation data was also collected as the sensors were in an ``ideal location'' as determined by a physical therapist. Four SEMG sensors were attached to the subject's dominant forearm in order to isolate activity of the subject's flexor and extensor carpi radialis and ulnaris muscles in order to gather this data.  Four sensor housings containing a piezo-electric force sensor in contact with the surface of the SEMG sensor were contained within a simulated socket described below in Sections \textit{\nameref{sec:socket}} and \textit{\nameref{sec:daq}}. The sensor placement referenced here as the ``ideal position'' can be seen in Figures \ref{fig:arm_out_no_socket} and \ref{fig:arm_socket}. All SEMG sensors were initially aligned to the muscle body during initial placement. \par \noindent

\subsubsection*{Simulating socket shift}
\label{sec:exp_prot-shift}

The first data set gathered was meant to test the effects of socket shift on classifier performance. The subject sat in a chair and rested their dominant arm on the chair's arm rest in a comfortable position.  The subject extended their wrist at least 10 times and returned to a neutral, resting position after each hand motion.  Next, the subject was instructed to flex their wrist at least 10 times, returning to a neutral, resting position as before.  After collecting data of these initial movements, the SEMG-FMG sensors and housing were rotated or shifted away from this ``ideal position".\par \noindent%  Sensor orientation parallel to the muscle body was maintained despite this simulated socket shift.     
By moving the sensor housing, we simulated the shifting of a user's prosthetic socket during activities of daily life.  The sensor housing was relocated from the ideal position by 1 cm.  Repositioning of the sensor housings occurred in four directions referred to as ``lateral'',towards the radius, ``medial'', towards the ulna, ``proximal", or shifted towards the elbow, and ``distal", or shifted towards the user's hand.  This process was then repeated, offsetting the sensors and sensor housing 2 cm from the ``ideal position".  All sensor housings were rotated or shifted in the same direction.  The subject repeated extension and flexion motions at least 10 times each, in each of the eight offset positions. \par \noindent
%Data and further discussion of experimental results are presented in Sections \textit{\nameref{sec:results}} and \textit{\nameref{sec:discussion}} sections.\par \noindent

\subsubsection*{Simulating arm positions during activities of daily living}
\label{sec:exp_prot-ADL}

Additionally, the subject repeated flexion and extension motions, with sensors in the ideal sensor locations, in several arm configurations while standing.  These arm configurations included positioning the shoulder laterally across the body (adduction), 90 degrees abduction, 135 degrees of shoulder flexion in the sagittal plane , ie. with the hand at approximately head-level, and 45 degrees shoulder flexion in the sagittal plane, ie. with the hand approximately waist-level.  Figure \ref{fig:arm_down}-~\ref{fig:arm_across} illustrates the basic arm positions used to during experimentation while the subject was standing.  \par \noindent

\begin{figure}[htbp]
\centering
\subfigure[]{\epsfig{figure=shoulder_down.png,height=1.4in}
\label{fig:arm_down}}
\subfigure[]{\epsfig{figure=shoulder_up2.png,height=1.52in}
\label{fig:arm_up}}
\subfigure[]{\epsfig{figure=shoulder_to_side.png,height=1.49in}
\label{fig:arm_out}}
\subfigure[]{\epsfig{figure=shoulder_across.png,height=1.45in}
\label{fig:arm_across}}
\caption{Arm positions used while gathering data while simulating arm positions found during activities of daily living. a) Arm 45 degrees shoulder flexion in the sagital plane (the hand approximately at waist-level) b) Arm 135 degrees of shoulder flexion in the sagittal plane (hand at approximately head-level) c) Arm out, away from the body (90 degrees abduction) d) Arm laterally across the body (adduction) with their elbow fully extended}

\end{figure}

\subsubsection*{SEMG and FMG while fatigued}
\label{sec:exp_prot-fatigued}

The subject was seated comfortably in a chair as described before in the in Section \textit{\nameref{sec:exp_prot-shift}}.  The subject sat, rested their arm in a comfortable position and positioned their hand in a neutral position.  The socket and sensor housing was placed in the ``ideal'' location on the arm above the forearm muscles. In order to create forearm muscle fatigue, the subject was then instructed to apply their maximum force to a sensorized-rectangular piece of plastic with their dominant hand in a ``key pinch'' grip.  A single piezeoresistive sensor was mounted between this piece of plastic and a solid surface with cellophane tape.  An initial reading of applied force was taken.  Following this initial reading, the subject squeezed a rubber ball covered in felt, ie. a tennis ball, ten times at a frequency of 60bpm. The metronome was used to provide auditory cues for a consistent squeeze rate.  The subject then squeezed the sensorized-rectangular piece of plastic as before.  This procedure of squeezing a tennis ball and immediately providing a force output measurement was repeated until the subject's output force measurement was 80\% of the initial reading.  All readings were taken with the socket in the ``ideal position'' as defined above.\par \noindent

\subsubsection*{Recording Radial and Ulnar Deviation of the hand}
\label{sec:exp_prot-hammer}

The subject was seated comfortably in a chair as described before in the in Section \textit{\nameref{sec:exp_prot-shift}}.  The subject sat, rested their arm in a comfortable position and positioned their hand in a neutral position with their thumb pointing ``up''.  The socket and sensor housing was placed in the ``ideal'' location on the arm above the forearm muscles.  The subject was instructed to deviate their wrist and hand in the ulnar direction, towards the ``pinky'' finger, repeating this motion at least 10 times.  The subject was instructed to return their hand to a neutral, resting position after each motion.  The subject was then instructed to deviate their hand in the radial direction, towards the thumb 10 times, returning to a resting neutral position following each motion.  \par \noindent
These movements are meant to capture data of the hand performing a simulated ``hammering'' or ``dart throwing'' motion, an activity common during daily life.


\section*{Materials} 
\label{sec:materials}

For this study we have prototyped a heterogeneous sensory input system to control a powered prosthetic device based around four SEMG sensors and four colocated piezo-resistive force sensors.  Activation of a desired control input is via excitation of the user's forearm muscles and the resulting increased intra-socket force and electromyograhpic signal. 

\subsection*{Socket and Sensor Housings}
\label{sec:socket}
%fix the name... get from Oguz

Initial work correlating surface EMG and intra-socket pressure made use of a simplified sensor housing was described in \cite{SanfordSPIE2015a} which can be seen in Figures ~\ref{fig:singlesensorhousinga} and ~\ref{fig:singlesensorhousingb}.  This setup allowed a single surface EMG and single pressure sensor to be co-located above the subject's forearm muscle, and easily relocated as part of that previous work.  %This system made use of a single Delsys wired-SEMG sensor.  A FlexiForce$\textsuperscript{\textregistered}$ A201 model piezo-resistive force sensor was used to detect intra-socket pressure\cite{FlexiForce2014}. A National Instruments myRIO device was connected to the force sensor via a voltage divider circuit and performed data acquisition at 100 Hz.  Further explanation of the data acquisition system can be found in Section ~\textit{\nameref{sec:daq}}.  \par \noindent
An expanded system, including housings for an opposing pair of pressure sensors was demonstrated in \cite{SanfordPETRA02015}.  This system continued to make use of piezo-resistive force sensors, using two opposing Flexiforce A201 sensors.  This system allowed a user access to two input modalities, flexion and extension of their dominant hand, by sensing changes of intra-socket pressure in a simulated prosthetic socket.  %A figure illustrating the socket used in \cite{SanfordPETRA02015} can be seen in Figure ~\ref{fig:twosensorsocket_worbla}.  Figure ~\ref{fig:twosensorsocket_CAD} shows a CAD model of a similar socket, for rapid prototyping and printing, able to accommodate a pair of opposing Delsys Bagnoli surface EMG sensors and colocated piezo-resistive pressure sensors.  
Figures ~\ref{fig:arm_out_no_socket} and ~\ref{fig:arm_socket} illustrate basic placement of the sensors above the muscle bodies activated during gross flexion and extension movements of the subject's dominant hand.  \par \noindent
\begin{figure}[h]
\centering
\subfigure[]{\epsfig{figure=top.png,width=2.05in}\label{fig:singlesensorhousinga}}
\subfigure[]{\epsfig{figure=side.png,width=2.05in}\label{fig:singlesensorhousingb}}
 \caption{Proof of Principle SEMG and colocated piezoresistive force sensor housing.  a) Top and b) Side views.  The SEMG sensor can be seen (dark grey), with the collocated force sensor (light grey) attached above it, but under the cantilever.}
\end{figure}
\begin{comment}
\begin{figure}[h]
\centering
\epsfig{figure=2sensor_socket.png,width=1.75in}
 \caption{Second iteration of healthy limb socket (rear view). Sensor housing seen in white.}
 \label{fig:twosensorsocket_worbla}
\end{figure}
\begin{figure}[h]
\centering
\epsfig{figure=two_sensor_socket_rear_view.png,width=2.5in}
 \caption{\textbf{\textit{maybe make the two experimental sockets one figure? Get Picture of Printed SOCKET}}}
 \label{fig:twosensorsocket_CAD}
\end{figure}
\end{comment}
\begin{comment}
\begin{figure}[htbp]
\centering
\subfigure[]{\epsfig{figure=2sensor_socket.png,width=1.52in}\label{fig:twosensorsocket_worbla}}
\subfigure[]{\epsfig{figure=C:/Users/Joe/Dropbox/Grad_School/Resesarch/My_Papers/EMG-FMG-Journal_Article/Figures/two_sensor_socket_rear_view.png,width=1.7in}\label{fig:twosensorsocket_CAD}}
\caption{a)Second iteration of healthy limb socket (rear view). Sensor housing seen in white. b) Rapid Prototyped, printed, socket in ABS Plastic }
\end{figure}
\end{comment}
The system used in this work expands on previous prototypes and includes four Delsys Bagnoli EMG sensors (Nattick, Massachusetts) and four collocated with FlexiForce A201 model piezo-resistive force sensors.  These sensors were positioned over the extensor and flexor muscles of the forearm as mentioned in Section \textit{\nameref{sec:protocol}}.  Sampling of EMG data occurred at 2.4kHz.  The four FMG sensors were mounted above the EMG sensors, in contact with the surface of the EMG sensors and the sensor housing.  Figure \ref{fig:arm_out_no_socket} illustrates the placement of one of the four pairs of EMG and Force sensors.\par \noindent
Prior to creation of the sensor housings, four EMG sensors were placed above the flexor and extensor muscles of the subject's dominant forearm.  These locations were marked on the subject's skin.  A three dimensional model of the subject's dominant arm was then created, using a 3DMD Flex4 \cite{3dMD} three dimensional scanning system to provide a scan of the subject's arm and CAD software.  A custom socket was created from this model and sensor housings were created above the marked EMG sensor locations.  The socket was 3-D printed using ABS plastic.  \par \noindent%The subject can be seen wearing the completed socket in Figure \ref{fig:arm_up}-\ref{fig:arm_out} while holding their arm in several positions used to test the system.\par \noindent 
\begin{comment}
\begin{figure}[htbp]
\centering
\subfigure[]{\epsfig{figure=arm_out_no_socket_crop_BW.png,width=2.5in}
\label{fig:arm_out_no_socket}}
\subfigure[]{\epsfig{figure=arm_socket_BW.png,width=2.5in}
 \label{fig:arm_socket}}
 \caption{a) Subject wearing SEMG and FMG collocated sensors b) Subject wearing simulated prosthetic socket and sensors}

\end{figure}
\end{comment}
\begin{comment}
\begin{figure}[htbp]
\centering
\subfigure[]{\epsfig{figure=shoulder_down.png,height=1.5in}
\label{fig:arm_down}}
\subfigure[]{\epsfig{figure=shoulder_up2.png,height=1.62in}
\label{fig:arm_up}}
\subfigure[]{\epsfig{figure=shoulder_to_side.png,height=1.55in}
\label{fig:arm_out}}
\subfigure[]{\epsfig{figure=shoulder_across.png,height=1.55in}
\label{fig:arm_across}}
\caption{a) Arm 45 degrees shoulder flexion in the sagital plane (the hand approximately at waist-level) b) Arm 135 degrees of shoulder flexion in the sagittal plane (hand at approximately head-level) c) Arm out, away from the body (90 degrees abduction) d) Arm laterally across the body (adduction)}

\end{figure}
\end{comment}

\subsection*{Data Acquisition}
\label{sec:daq}

A Delsys Bagnoli EMG system, National Instruments DAQ, a custom circuit including an Arduino Micro and LabVIEW program were used to gather data for this work.  The Delsys Bagnoli 16 channel EMG system was directly connected to an NI (National Instruments) USB-6210 DAQ for EMG data acquisition.  A custom voltage divider circuit was created to gather pressure data from the four piezoresistive sensors, making use of an Arduino Micro micro-controller.  This voltage divider circuit was also connected to the NI USB-6210 DAQ. In conjunction to the mentioned hardware, a custom LabVIEW VI program was written.  This program allows users to start and stop data gathering, change data sampling rates, view data in real-time in a graphical display, and output data to TDMS file formats.  These TDMS files are later processed and classified and are described in \textit{\nameref{sec:classifier}}.

\subsection*{Classification Algorithm}
\label{sec:classifier}

A custom Matlab program was created to process the gathered data, classify that data using a feed-forward neural network, and determine the motion of the subject's hand.  Data acquired using the system described in \textit{\nameref{sec:daq}} was converted from TDMS file format to CSV for processing.  \par \noindent
Then, EMG and FMG data was classified using the Matlab Neural-Network Toolbox in a multi-layer perceptron feed-forward configuration.  SEMG parameters described by Hudgins, \textit{et., al} are used as network inputs along with piezo-resistive pressure sensor data\cite{Hudgins01993}.  These inputs to the network were the moving average of the absolute value of the SEMG signal, the derivative of the absolute value of the SEMG data, and the absolute value of the pressure data. The time vectors of SEMG data and pressure data are denoted as $r_{t}$ and $p_{t}$ respectively. $\hat{r}_t$ is defined as the magnitude of the time vector of SEMG data, as seen in Equation~\ref{eq:r_hat}.
\begin{align}
\label{eq:r_hat}
\hat{r}_t = \lvert r_t \rvert
\end{align}
The Central Moving Average of the absolute value of the SEMG signal is referred to as \textit{MA} and has window size denoted, $\omega_1$.  A \textit{central moving average} computation was performed shown, in Equation~\ref{eq:CMA_r_hat}.  
\begin{align}
\label{eq:CMA_r_hat}
\tau_1 = MA_{\hat{r}_t} = \frac{1}{\omega_1}\hat{r}_{(t-\omega_1)} + \frac{1}{\omega_1}\hat{r}_{(t-\omega_1-1)} + \frac{1}{\omega_1}\hat{r}_{(t-\omega_1-2)} + \ldots + \nonumber \\
+ \frac{1}{\omega_1}\hat{r}_{(t)} + \ldots + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1-2)} + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1-1)} + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1)}
\end{align}
Finally, a simple difference calculation, using window size $\omega_2$, was substituted in place of the derivative of the absolute value of the SEMG data during calculation (Equation~\ref{eq:slope_r_hat}).  
\begin{equation}
\label{eq:slope_r_hat}
\tau_2 = \textit{slope}(MA_{\hat{r}_t}) = MA_{\hat{r}_t} - MA_{\hat{r}_(t-\omega_2)}\\
\end{equation}
A Central Moving Average and slope calculation occurred for the pressure data, shown in Equation ~\ref{eq:slope_p_hat}.  
\begin{equation}
\label{eq:slope_p_hat}
	\tau_3 = \textit{slope}(MA_{\hat{p}_t}) = MA_{{p}_t} - MA_{{p}_(t-\omega_2)}\\
\end{equation}
70$\%$ of the sampled moving difference window data was used as training input, testing and validation evenly split between the remaining 30$\%$.  All data was subdivided in to these groups, training, testing, and validation randomly. \par \noindent

\begin{comment}
\begin{align}
\hat{r}_t = \lvert r_t \rvert \\
\tau_1 = MA_{\hat{r}_t} = \frac{1}{\omega_1}\hat{r}_{(t-\omega_1)} + \frac{1}{\omega_1}\hat{r}_{(t-\omega_1-1)} + \frac{1}{\omega_1}\hat{r}_{(t-\omega_1-2)} + \ldots + \nonumber \\
+ \frac{1}{\omega_1}\hat{r}_{(t)} + \ldots + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1-2)} + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1-1)} + \frac{1}{\omega_1}\hat{r}_{(t+\omega_1)}\\
	\tau_2 = \textit{slope}(MA_{\hat{r}_t}) = MA_{\hat{r}_t} - MA_{\hat{r}_(t-\omega_2)}\\
	\tau_3 = \textit{slope}(MA_{\hat{p}_t}) = MA_{{p}_t} - MA_{{p}_(t-\omega_2)}
\end{align}
\end{comment}

%\par \noindent 
\begin{figure}[htbp]
\centering
\epsfig{figure=IO_Diagram1.png,width=2.75in}
 \label{fig:io_diagram}
 \caption{Network Topology of Feedforward MLP used in this work. Inputs $\tau_1$, $\tau_2$, and $\tau_3$ are seen}

\end{figure}

Data were classified for an action when the SEMG moving average was above signal noise, the slope was positive over a moving window, and pressure data showed a positive value over a moving window. The SEMG noise-threshold was found by multiplying the CMA value by 1.5 (for SEMG). Hidden layer sizes of 1-10, 50, 100, and 1000 were tested. A 10 neuron hidden layer size was chosen and used for training as significant improvements to classification error rate percentages were not seen beyond this value. A more detailed explanation of this process can be found in previous work, \cite{SanfordSPIE2015a}, along with sample SEMG and FMG data and wave-forms.  Training was repeated until no significant improvement in the network weights or outputs was seen, approximately ten times.  The \textit{scaled conjugate gradient} method was used to update weights and bias values\cite{Moller1993}. \par \noindent%A discussion of neural network training processes can be found in the literature, including the excellent examples found in \cite{CourseraNg2016}.  \par \noindent% Further  discussion of these thresholds and the performance of the trained network can be found below. \par \noindent
Data were classified using one of the eight trained multi-layer perceptron, feed-forward neural network classifiers.  Four of these classifiers included training data solely consisting of EMG data.  Separately, four neural networks were trained considering each SEMG-FMG pair, for a total of eight inputs and two outputs with the result of determining if an action had occurred.  Separately, two networks were trained to classify wrist deviation, one using SEMG data only and one using both SEMG and FMG data.\par \noindent
Training data for the first eight networks consisted of data while the subject was seated and the socket and sensors were in the ``ideal'' position, while the subject was standing and the socket was in the ``ideal'' position, and while the subject was seated and the socket had been shifted.  Descriptions of these data sets can be found in Section \textit{\nameref{sec:protocol}}.  Training of the two additional networks, as part of the data set described in Section \textit{\nameref{sec:exp_prot-hammer}}, occurred while the subject was seated and the socket was placed in the ``ideal'' position. Data from the data set described in Section \textit{\nameref{sec:exp_prot-fatigued}}, while the subject was fatigued, was not included in any training set. Discussion of this exclusion can be found below.  A table describing which data are included in each of the eight data sets used to train the classifiers can be seen in Table ~\ref{tab:groups}. Column labels can be described as: EMG, FMG, ``ideal'' socket position, various arm positions while standing, and ``shifted'' socket positions.  The ``shifted socket'' data were included in a single training set and classifier.  For clarity during discussion below, the classifiers will be referred to by a short-hand, concatenating the names of the data sets used to train the networks.  For example, \textit{Classifier 1} will be referred to as ``EMG$\_$I'', ie. ``EMG data while the socket is in the ``ideal'' position'' (Classifier 2-EMG$\&$FMG$\_$I, Classifier 3-EMG$\_$ISt, Classifier 8-EMG$\&$FMG$\_$IStSh etc.).


\begin{table}[htbp]
  \centering
   \caption{Experimental Data Included in Each Training Set for each Neural Network Classifier}
    \begin{tabular}{lrrrllll}
    \toprule
    \textbf{} & \multicolumn{2}{c}{\textbf{Sensors}} & \textbf{} & \multicolumn{4}{l}{\textbf{Socket/ Arm Position}} \\
    \\
    \\
    \textbf{} & \begin{rotate}{30}\textbf{EMG}\end{rotate}  & \begin{rotate}{30} \textbf{FMG}\end{rotate} & & \textbf{} & \begin{rotate}{30}\textbf{ideal}\end{rotate} &  \begin{rotate}{30}\textbf{standing}\end{rotate} & \begin{rotate}{30} \textbf{shifted} \end{rotate} \\
    \textbf{Classifier 1} & \textbf{X} & \textbf{} & & & \textbf{X} &  \textbf{} & \textbf{} \\
    \textbf{Classifier 2} & \textbf{X} & \textbf{X} & & & \textbf{X} & \textbf{} & \textbf{} \\
    \textbf{Classifier 3} & \textbf{X} & \textbf{} & & & \textbf{X} &  \textbf{X} & \textbf{} \\
    \textbf{Classifier 4} & \textbf{X} & \textbf{X} & & & \textbf{X} & \textbf{X} & \textbf{} \\
    \textbf{Classifier 5} & \textbf{X} & \textbf{} & & & \textbf{X} &  \textbf{} & \textbf{X} \\
    \textbf{Classifier 6} & \textbf{X} & \textbf{X} & & & \textbf{X} & \textbf{} & \textbf{X} \\
    \textbf{Classifier 7} & \textbf{X} & \textbf{} & & & \textbf{X} &  \textbf{X} & \textbf{X} \\
    \textbf{Classifier 8} & \textbf{X} & \textbf{X} & & & \textbf{X} & \textbf{X} & \textbf{X} \\
    \bottomrule
    \end{tabular}%
  \label{tab:groups}%
\end{table}%



\section*{Results}
\label{sec:results}

Eight different classifiers were trained.  The first two classifiers were trained using only data collected while the socket was in the ``ideal'' position and the subject was seated. These classifiers are used as a base or control to compare against. The first of the two control classifiers included only data from the EMG sensors.  The second control classifier included EMG and FMG data.  A table describing the data included in each training data set can be seen in Table ~\ref{tab:groups}.  Data sets 1 and 2, as labeled in the above mentioned table, are the control data sets.  All eight networks were tested against data while the socket was in the ``ideal'' position while the subject was seated, against shifted socket data, against data gathered while the subject was  standing, and against data gathered during times of subject fatigue.  Comparisons were also made between classifiers not including pressure data and those that included intrasocket pressure data.  Final results of classification of data during times of fatigue are reported.  However, no data from trials during times of fatigue were included in training data.  Separately, two networks were trained to classify radial and ulnar deviation of the hand while the simulated socket was in the ``ideal'' position and the subject was seated. \par \noindent %Figures ~\ref{fig:1vsStanding}-~\ref{fig:8vsFatigue} and Figures ~\ref{fig:hammer_4inputs}-~\ref{fig:hammer_8inputs} 
Figures ~\ref{fig:1vsStanding}-~\ref{fig:hammer_8inputs} show the results of classification, presented as confusion matrices. The \textit{main diagonals indicate the percentages of ``correct'' classification} for flexion and extension, radial or ulnar deviation, or ``no action''.   \textit{Off-diagonal values show the percentages of mis-classifications}. Data is presented as averages of flexion and extension classification data over the entire experiment, for each classifier.  The entire matrix will sum to approximately 100$\%$, due to rounding of significant digits.  An additional discussion of confusion matrices can be found in \cite{Moller1993} and \cite{CourseraNg2016}.

\subsubsection*{Performance against Arm Positions during Activities of Daily Living}
\label{sec:res_arm}

\begin{comment}
Data comparing different training data sets to Standing

ideal, standing, shift -> standing
ideal, shift -> standing
ideal, standing -> standing
ideal -> standing
\end{comment}

\begin{figure*}[htbp]
\centering
\subfigure[]{\epsfig{figure=Classifier_1_vs_Standing_Data.png,width=1.6in}
\label{fig:1vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_2_vs_Standing_Data.png,width=1.6in}
\label{fig:2vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_3_vs_Standing_Data.png,width=1.6in}
\label{fig:3vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_4_vs_Standing_Data.png,width=1.6in}
\label{fig:4vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_5_vs_Standing_Data.png,width=1.6in}
\label{fig:5vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_6_vs_Standing_Data.png,width=1.6in}
\label{fig:6vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_7_vs_Standing_Data.png,width=1.6in}
\label{fig:7vsStanding}}
\subfigure[]{\epsfig{figure=Classifier_8_vs_Standing_Data.png,width=1.6in}
\label{fig:8vsStanding}}
\caption{Confusion Matrices comparing Classifiers to Standing Data. Matrices a, c, e, g, used on SEMG data. Matrices b, d, f, h used SEMG and FMG data. a) Classifier 1-EMG$\_$I b) Classifier 2-EMG$\&$FMG$\_$I c) Classifier 3-EMG$\_$ISt d) Classifier 4-EMG$\&$FMG$\_$ISt e) Classifier 5-EMG$\_$ISh f) Classifier 6EMG$\&$FMG$\_$ISh g) Classifier 7-EMG$\_$IStSh h) Classifier 8-EMG$\&$FMG$\_$IStSh}

\end{figure*}

This section reports results of the eight neural networks when classifying data described in Sec. \textit{\nameref{sec:exp_prot-ADL}}.  The movements made by the subject simulated arm positions during activities of daily living.  The subject performed wrist flexion and extension motions while their dominant arm was in the four positions as seen in Fig. \ref{fig:arm_up}-~\ref{fig:arm_across}.  Figures ~\ref{fig:1vsStanding}-~\ref{fig:8vsStanding} report the average performance data for each classifier, for each data set.  \par \noindent

\subsubsection*{Performance against Socket Shift}
\label{sec:res_shift}

\begin{comment}
Data comparing different training data sets to shift

ideal, standing, shift -> shift
ideal, shift -> shift
ideal, standing -> shift
ideal -> shift
\end{comment}

\begin{figure*}[htbp]
\centering
\subfigure[]{\epsfig{figure=Classifier_1_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:1vsShift}}
\subfigure[]{\epsfig{figure=Classifier_2_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:2vsShift}}
\subfigure[]{\epsfig{figure=Classifier_3_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:3vsShift}}
\subfigure[]{\epsfig{figure=Classifier_4_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:4vsShift}}
\subfigure[]{\epsfig{figure=Classifier_5_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:5vsShift}}
\subfigure[]{\epsfig{figure=Classifier_6_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:6vsShift}}
\subfigure[]{\epsfig{figure=Classifier_7_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:7vsShift}}
\subfigure[]{\epsfig{figure=Classifier_8_vs_Socket_Shift_Data.png,width=1.6in}
\label{fig:8vsShift}}
\caption{Confusion Matrices comparing Classifiers to Socket Shift Data. Matrices a, c, e, g, used on SEMG data. Matrices b, d, f, h used SEMG and FMG data. a) Classifier 1-EMG$\_$I b) Classifier 2-EMG$\&$FMG$\_$I c) Classifier 3-EMG$\_$ISt d) Classifier 4-EMG$\&$FMG$\_$ISt e) Classifier 5-EMG$\_$ISh f) Classifier 6EMG$\&$FMG$\_$ISh g) Classifier 7-EMG$\_$IStSh h) Classifier 8-EMG$\&$FMG$\_$IStSh}

\end{figure*}

Figures ~\ref{fig:1vsShift}-~\ref{fig:8vsShift} report results of the eight neural networks when classifying data described in Sec. \textit{\nameref{sec:exp_prot-shift}}.  This experiment simulated socket shift as experienced when a prosthetic socket moves due to socket-pull-out or poor socket fit.  The subject performed wrist flexion and extension motions while their dominant arm was resting on an arm rest.  The simulated prosthetic socket was then moved, as described above, 1cm and 2cm away from the ``ideal'' socket position.  Figures ~\ref{fig:1vsShift}-~\ref{fig:8vsShift} report the average performance data for each classifier, for each data set.  \par \noindent

\subsubsection*{Performance against Fatigue}
\label{sec:res_fatigue}

\begin{comment}
Data comparing different training data sets to fatigue

ideal, standing, shift -> fatigue
ideal, shift -> fatigue
ideal, standing -> fatigue
ideal -> fatigue
\end{comment}

\begin{figure*}[htbp]
\centering
\subfigure[]{\epsfig{figure=Classifier_1_vs_Fatigue_Data.png,width=1.6in}
\label{fig:1vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_2_vs_Fatigue_Data.png,width=1.6in}
\label{fig:2vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_3_vs_Fatigue_Data.png,width=1.6in}
\label{fig:3vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_4_vs_Fatigue_Data.png,width=1.6in}
\label{fig:4vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_5_vs_Fatigue_Data.png,width=1.6in}
\label{fig:5vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_6_vs_Fatigue_Data.png,width=1.6in}
\label{fig:6vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_7_vs_Fatigue_Data.png,width=1.6in}
\label{fig:7vsFatigue}}
\subfigure[]{\epsfig{figure=Classifier_8_vs_Fatigue_Data.png,width=1.6in}
\label{fig:8vsFatigue}}
\caption{Confusion Matrices comparing Classifiers to Fatigue Data. Matrices a, c, e, g, used on SEMG data. Matrices b, d, f, h used SEMG and FMG data. a) Classifier 1-EMG$\_$I b) Classifier 2-EMG$\&$FMG$\_$I c) Classifier 3-EMG$\_$ISt d) Classifier 4-EMG$\&$FMG$\_$ISt e) Classifier 5-EMG$\_$ISh f) Classifier 6EMG$\&$FMG$\_$ISh g) Classifier 7-EMG$\_$IStSh h) Classifier 8-EMG$\&$FMG$\_$IStSh}

\end{figure*}

Figures ~\ref{fig:1vsFatigue}-~\ref{fig:8vsFatigue} report results of the eight neural networks when classifying data collected in Sec. \textit{\nameref{sec:exp_prot-fatigued}}.  This experiment simulated user fatigue as experienced throughout a user's typical day of powered prosthetic use.  The subject squeezed a felt ball ten times and then squeezed a force sensor.  These motions were repeated until the force output was reduced to a 80\% of the initial force output. The user then performed wrist flexion and extension motions while their dominant arm was resting on an chair's arm rest.  Figures ~\ref{fig:1vsFatigue}-~\ref{fig:8vsFatigue} report the average performance data for each classifier, for each data set.  \par \noindent

\subsubsection*{Performance of Radial and Ulnar Deviation Classification}
\label{sec:res_hammer}
\begin{figure*}[htbp]
\centering
\subfigure[]{\epsfig{figure=Hammer_Motion_SEMG_only.png,width=1.6in}
\label{fig:hammer_4inputs}}
\subfigure[]{\epsfig{figure=Hammer_Motion_SEMG_&_FMG.png,width=1.6in}
\label{fig:hammer_8inputs}}
\caption{Confusion Matrix reporting classification results for radial and ulnar deviation of the hand a) 4 SEMG inputs b) SEMG and FMG inputs}
\end{figure*}

Figures ~\ref{fig:hammer_4inputs} and ~\ref{fig:hammer_8inputs} report results of the trained neural network when classifying data collected in Sec. \textit{\nameref{sec:exp_prot-hammer}}.  The movements made by the subject simulated radial and ulnar deviation of the a user's hand during activities of daily living, such as during a ``hammer'' or ``dart throwing'' action.  The subject deviated their dominant wrist ten times in the radial direction and then ten times in the ulnar direction while their dominant arm was resting on an chair's arm rest.  Figure ~\ref{fig:hammer_4inputs} reports the average performance data for the classifier for this experiment using only the four SEMG sensors as input.  Figure ~\ref{fig:hammer_8inputs} reports the performance data for the classifier for this experiment using the four SEMG sensors and the four FMG sensors as input.  These classifiers were trained and tested against data from this experiment only; 70\% of the time samples were used for training, 15\% for validation, 15\% for testing. \par \noindent

\section*{Discussion} 
\label{sec:discussion}

Flexion and extension motions were chosen for this study as a means of testing data typically available to ``the greatest number of lower arm prosthetic users''.  Current commercial upper limb prosthetics already use SEMG from wrist flexion and extension.  While it is true that clinical results using the most advanced techniques available in the literature boast classification results much higher then those presented here, the classifiers trained in this study were chosen for the simplicity and ease of implementation and to provide a baseline performance for comparison of classification of SEMG data to SEMG-FMG data.  The improvements in classification rate percentages are significant considering the simplicity of these techniques. The results of classification using more advanced non-linear classifiers, such as Radial Basis Functions or Gaussian Mixture Models, will then have a basis for comparison.  \par \noindent%  This can best be illustrated by the ``hot coffee'' problem where a relatively small improvement in classification rate can have significant improvement in the end-user's experience. 
It can be seen from Figures ~\ref{fig:1vsStanding}-~\ref{fig:8vsFatigue} that in general, those classifiers trained using larger training sets, \textit{Classifiers 7} \& \textit{8} performed better than the classifiers including shorter training sets, \textit{Classifiers 1-EMG$\_$I} \& \textit{2-EMG$\&$FMG$\_$I}.  It is thought that inclusion of more data, more examples of flexion and extension motions, provides a more robust classifier.  This can be illustrated by comparing the classification of activities of daily living data using different classifiers trained using different training data sets; 74.47$\%$ (\textit{Classifiers 1-EMG$\_$I}), 77.88$\%$ (\textit{Classifiers 2-EMG$\&$FMG$\_$I}), 81.51$\%$ (\textit{Classifiers 7-EMG$\_$IStSh}), and 81.35$\%$ ((\textit{Classifiers 8-EMG$\&$FMG$\_$IStSh}).  This was also confirmed by Fougner \textit{et, al} during their experiments which included data collected with the subject's arm in various positions and not just resting on a table top or a chair's arm. \par \noindent
From the data gathered as described in Sec. \textit{\nameref{sec:exp_prot-ADL}} \& \textit{\nameref{sec:exp_prot-shift}}, it can be seen that those classifiers including intrasocket pressure data and SEMG outperformed classifiers with data collected from surface EMG only.  This is especially true when considering \textit{Classifiers 1-EMG$\_$I} \& \textit{2-EMG$\&$FMG$\_$I} during socket shifts, 35$\%$ compared to ~70$\%$ classification rate.  These classifiers were not trained with data collected when the socket was shifted but were tested against ``shifted'' data (Section \textit{\nameref{sec:exp_prot-shift}}.  Interestingly, \textit{Classifiers 3-EMG$\_$ISt} \& \textit{4-EMG$\&$FMG$\_$ISt}, trained including data while the subject's arm was in different positions, outperformed \textit{Classifiers 2-EMG$\&$FMG$\_$I}.  Comparing \textit{Classifiers 2-EMG$\&$FMG$\_$I} \& \textit{3-EMG$\_$ISt}, one can see that a classifier using four SEMG and four FMG sensors is nearly as accurate as a classifier including additional training data.  This could have implications during initial training, implementation, and deployment for a prosthetic user. One can imagine a system allowing for retraining of the classifier ``at home, by the user'' should functionality degrade. It would be preferable to have a shorter number of ``retraining motions'' needed in this case.\par \noindent
Fougner, \textit{et al.} and Radman report to have improved SEMG signal classification errors due to limb position effects through fusion with accelerometry data {Fougner2011,Fougner2012, Radman02014}. While effective, more computationally intense data processing and classifiers were needed than were used in this work, a \textit{linear discriminant analysis classifier} specifically. A larger array of SEMG sensors were necessary as well, eight (Fougner) and six (Radman) EMG sensors, along with additional accelerometers.  It should also be noted that while socket shift was said to be accounted for in these work, actual socket or sensor displacement due to activities of daily living was not measured. This displacement was deliberately accounted for in the work presented here.  Experiment \textit{\nameref{sec:exp_prot-ADL}} is meant as a means to effectively compare against the shifted socket, Experiment \textit{\nameref{sec:exp_prot-shift}}, where the sensor housings were displaced a controlled distance away from the ideal position.  By performing linear shifts while the subject's arm was resting on a chair's arm-rest, EMG effects due to varied arm positions can be eliminated.\par \noindent
From data found in Fig. ~\ref{fig:1vsStanding}-~\ref{fig:8vsStanding}, one can see that \textit{Classifiers 3-EMG$\_$ISt - 8-EMG$\&$FMG$\_$IStSh} performed approximately equally.  But, they did outperform \textit{Classifier 2-EMG$\&$FMG$\_$I} which in turn outperformed \textit{Classifier 1-EMG$\_$I}.  That is to say that classifiers including SEMG and FMG data as part of their training sets performed approximately equally to classifiers including only SEMG data when additional training data collected when the subject's arm is in different positions, is included.  But, a classifier using the eight sensor set up outperforms the SEMG-only setup when additional training data is \textit{not} included.  This same conclusion can be made when comparing and classifying samples during times of user fatigue as seen in Fig. ~\ref{fig:1vsFatigue}-~\ref{fig:7vsFatigue}.   \par \noindent
It should be noted that while the subject reported their arm ``feeling tired'', they did not report ``feeling sweaty''.  A degradation of the measured amplitude of the SEMG signal of 2\%-3\%, depending on the type of sensor used, for every 0.02mm of sweat between the surface of the skin and the sensor was determined in \cite{Abdoli-Eramaki2012}.  Perspiration, a conductive fluid, can also cause intermittent short-circuits of an EMG sensor.  While this can be partially compensated for as proposed by \cite{Ray1983}, a high frequency oscillator is necessary for signal injection, and is not used in clinical settings and the author is unaware of any production systems making use of this method.  The system presented in this paper avoids EMG signal degradation issues due to sweat by making use of a multi-modal sensory input.  Despite this, future experiments should attempt to force the subject to exert themselves  enough to cause sweat on the skin surface in order to further test the SEMG-FMG system.   \par \noindent 
Figures ~\ref{fig:hammer_4inputs} \& ~\ref{fig:hammer_8inputs} report findings from classification of radial and ulnar deviation motions of the subject's wrist and hand.  These motions are found during several activities of daily living, including ``hammering'', ``dart throwing'' and many others.  A significant improvement in classification can be seen between the two methods presented here, using only surface EMG and using a combination of surface EMG and force myography.  It is believed that a more advanced classification algorithm could provide even further improvements. To this author's knowledge, classification of these actions has not been reported before in the literature.  Previous work has focused on improving dexterous finger motions and classification.  It should be noted that also to this author's knowledge, no powered prosthetic devices currently available to the public are able to provide this capability to a robotic hand. Currently, only  wrist rotation actions are possible with available devices. The authors feel that the addition of radial and ulnar deviation to a powered device would improve usability and decrease long-term, compounding injuries of the remainder limb's elbow and shoulder joints.\par \noindent
It should also be noted that although methods for classifier training will be the same across a cohort of subjects, due to customization of the socket, only a single subject was considered at this time.  Future work will necessitate testing of this technique using a larger number of subjects as well as a trans-radial powered prosthetic user.\par \noindent
No training sets included data collected during the fatigue experiment of \textit{\nameref{sec:exp_prot-fatigued}}.  This protocol was used due to hardware limitations and in an attempt to measure classification robustness as the user perspired.  Due to the nature of the method of data acquisition and signal processing performed and described above in Section \textit{\nameref{sec:daq}} and \textit{\nameref{sec:classifier}}, EMG signal frequency was not recorded. Future hardware will take this in to account, measuring the median EMG signal frequency, and using this as a means of determining user fatigue.  Despite these limitations, this protocol allowed us to gather data and see that \textit{Classifiers 3-EMG$\_$ISt - 8-EMG$\&$FMG$\_$IStSh} were able to perform approximately equally and classify user intent. \par \noindent
Prior work by Young \textit{et, al} discusses classification errors based on socket shift direction along the muscle body\cite{Young2011}.  Young \textit{et, al}  found that socket shift, sensor displacement, affected classification more readily when the socket shifted perpendicularity to the muscle fiber, ie, rotated around the arm as compared to moved more distally or proximally.  While we gathered data shifted in a similar method to Young\textit{et, al}, we did not control for direction of shift as part of the classifier training. Only linear distance away from an ideal location was considered and controlled for. Study of classification results from a limited data set, taking shift direction in to account, should be undertaken. Future work may show that improvements in a reduction of training motions can be made by only rotating the socket without also moving the socket distally and proximally along the forearm. \par \noindent 
While fine gesture recognition for highly dexterous motions is beyond the scope of this study, it has been considered in works by Scheme and Fougner, for example.  While there has been interest in classifying data from a large array of EMG sensors, the advantages of studying smaller arrays for pattern recognition are apparent.  Implementation will require real-time control of a device, making use of a micro-controller, more readily possible with fewer input signals.  Sensor size must also be taken in to account when constructing a practical socket as well as actual, available muscle sites on a prosthetic user. \par \noindent
Advanced classification algorithms were not considered as part of this study as the goal was to test an SEMG-FMG system against an SEMG only system, using a known classification algorithm as a bench-mark. Additionally, large training sets were compared to more simple training sets.  Classifiers trained in the  method shown here would also inherently be tailored to an individual user and their individual SEMG and FMG signal profiles; generalized systems trained on data not gathered from the individual would not perform as desired.  This is not seen as a disadvantage as training times are small and future systems could allow for retraining of systems online. 

\section*{Conclusion}
\label{sec:conclusion}

This proof of concept system has provided insight and considerations in to training data and sensor configurations for future powered prosthetic and human-robot systems.  We have shown that given basic training data created by a subject seated in a chair, a system of collocated SEMG and FMG, and a basic neural network classifier performs better than a system trained using only SEMG data by at least 3\% against data collected during arm movements found in daily life. An even more significant improvement was seen against data collected during times of subject fatigue and socket shift, 8\% and 35\% respectively.  Additional and more complex training sets consisting of data gathered during shift of the prosthetic socket performs as well as, or better than, systems trained using data gathered during arm motions of daily living while standing.  Should a user only be able to perform a single additional training data set, socket shift movements should be considered over arm movements with considerations for socket rotation.  Insight in to classifying data gathered during times of user fatigue was gained. And although systems making use of additional training data outperformed systems including only basic training data during fatigued tasks, no information could be gained for tasks performed while a user was perspiring at this time.  Further, while data during times of fatigue were not included in training sets, due to limitations of hardware and software restrictions, classification of data during times of fatigue were possible and did show improvements using the proposed system. Classification of radial and ulnar deviation of the wrist was shown to be possible, with a significant classification improvement of the SEMG-FMG system over the traditional SEMG only system. Future work will include implementation of DC offset compensation \cite{Tomasini2015}. This should further improve the captured signals.  Training using the recurrent neural network method, a more computationally intensive training algorithm, is considered impractical at this time but will be considered during future work.  Other, more complex training algorithms will be considered and tasks designed to force a subject to exert themselves and cause perspiration will be performed with the eventual goal of improving a powered prosthetic user's ability to interact with objects found in their daily life.

\begin{acks}
\label{sec:acknowledgments}
The authors would like to thank the people at the University of North Texas - Health Science Center Human Movement Performance lab for the assistance with this experiment, especially Carolyn Young.  \par 
The authors would like to note the contributions of Roopak Karulkar and JPaul Carpenter of the NGS Group at UT-Arlington in the design and building of our prototypes.
\end{acks}

\begin{funding}
This work was supported by National Science Foundation NRI Grant $\#$IIS-1208623.
\end{funding}


\bibliographystyle{SageV}
%\bibliographystyle{SageH}
%\bibliography{C:/Users/Joe/Dropbox/Grad_School/Resesarch/My_Papers/EMG-FMG-Journal_Article/emg-fmg-journal-article-SAGE/library}
\bibliography{library}

% that's all folks
\end{document}
